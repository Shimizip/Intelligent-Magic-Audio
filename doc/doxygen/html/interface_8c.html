<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>I M A (Intelligent Magic Audio): f401_display_encoder_fader_test/Core/Src/interface.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">I M A (Intelligent Magic Audio)
   </div>
   <div id="projectbrief">Audio Sampling Eurorack Module with neuronal based sample classification and intelligent search filtering</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_957422d37a9a04baf7493b8f6f0a5e62.html">f401_display_encoder_fader_test</a></li><li class="navelem"><a class="el" href="dir_96bf4774b4d648f8211917df1cf57207.html">Core</a></li><li class="navelem"><a class="el" href="dir_84547b0d4d3c3430d75abcd9dabf77e2.html">Src</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">interface.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>: Interface functions for handling user inputs, file management, and display updates  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="interface_8h_source.html">interface.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0cd91fd3a9608559c2a87a8ba6cba55f" id="r_a0cd91fd3a9608559c2a87a8ba6cba55f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0cd91fd3a9608559c2a87a8ba6cba55f">HAL_GPIO_EXTI_Callback</a> (uint16_t GPIO_Pin)</td></tr>
<tr class="memdesc:a0cd91fd3a9608559c2a87a8ba6cba55f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback function that responds to encoder signals.  <br /></td></tr>
<tr class="separator:a0cd91fd3a9608559c2a87a8ba6cba55f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a3b0ad512a6e6c6157440b68d395eac" id="r_a8a3b0ad512a6e6c6157440b68d395eac"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8a3b0ad512a6e6c6157440b68d395eac">HAL_TIM_PeriodElapsedCallback</a> (TIM_HandleTypeDef *htim)</td></tr>
<tr class="memdesc:a8a3b0ad512a6e6c6157440b68d395eac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback function triggered when a timer expires.  <br /></td></tr>
<tr class="separator:a8a3b0ad512a6e6c6157440b68d395eac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af20a88180db1113be1e89266917d148b" id="r_af20a88180db1113be1e89266917d148b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af20a88180db1113be1e89266917d148b">HAL_ADC_ConvCpltCallback</a> (ADC_HandleTypeDef *hadc)</td></tr>
<tr class="memdesc:af20a88180db1113be1e89266917d148b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback function for the ADC conversion.  <br /></td></tr>
<tr class="separator:af20a88180db1113be1e89266917d148b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ce89a950d7397271c896ef778373d7e" id="r_a3ce89a950d7397271c896ef778373d7e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3ce89a950d7397271c896ef778373d7e">screenInit</a> (char(*fileNames)[MAX_FILENAME_LENGTH])</td></tr>
<tr class="memdesc:a3ce89a950d7397271c896ef778373d7e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the screen and sets up the file manager with random class percentages.  <br /></td></tr>
<tr class="separator:a3ce89a950d7397271c896ef778373d7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af18dbb5e3f6d43a5504216e1f427cfdd" id="r_af18dbb5e3f6d43a5504216e1f427cfdd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af18dbb5e3f6d43a5504216e1f427cfdd">sortFiles</a> (void)</td></tr>
<tr class="memdesc:af18dbb5e3f6d43a5504216e1f427cfdd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sorts filenames for display based on fader settings.  <br /></td></tr>
<tr class="separator:af18dbb5e3f6d43a5504216e1f427cfdd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a613aa0c99c5b2234f909f5f8b0cdc972" id="r_a613aa0c99c5b2234f909f5f8b0cdc972"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a613aa0c99c5b2234f909f5f8b0cdc972">updateScreen</a> (void)</td></tr>
<tr class="memdesc:a613aa0c99c5b2234f909f5f8b0cdc972"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the display with filenames, the currently selected file, and fader settings.  <br /></td></tr>
<tr class="separator:a613aa0c99c5b2234f909f5f8b0cdc972"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5a2a772fa51a752d6fbe6d902aa4bce" id="r_aa5a2a772fa51a752d6fbe6d902aa4bce"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa5a2a772fa51a752d6fbe6d902aa4bce">compareADCValues</a> (void)</td></tr>
<tr class="memdesc:aa5a2a772fa51a752d6fbe6d902aa4bce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if fader settings have changed and updates accordingly.  <br /></td></tr>
<tr class="separator:aa5a2a772fa51a752d6fbe6d902aa4bce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ba638cf01ae1b79501208d3ed35c394" id="r_a8ba638cf01ae1b79501208d3ed35c394"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8ba638cf01ae1b79501208d3ed35c394">resetShownFiles</a> (void)</td></tr>
<tr class="memdesc:a8ba638cf01ae1b79501208d3ed35c394"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resets the <code>shownFiles</code> array and updates the number of matched files.  <br /></td></tr>
<tr class="separator:a8ba638cf01ae1b79501208d3ed35c394"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a90e886ffd55777b46a49d913a49a6c" id="r_a0a90e886ffd55777b46a49d913a49a6c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0a90e886ffd55777b46a49d913a49a6c">listFiles</a> (const char *path)</td></tr>
<tr class="memdesc:a0a90e886ffd55777b46a49d913a49a6c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Lists all filenames with a .wav extension from the specified directory on the SD card.  <br /></td></tr>
<tr class="separator:a0a90e886ffd55777b46a49d913a49a6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca22e5ccdba198907a9b2c14b1e93540" id="r_aca22e5ccdba198907a9b2c14b1e93540"><td class="memItemLeft" align="right" valign="top"><a id="aca22e5ccdba198907a9b2c14b1e93540" name="aca22e5ccdba198907a9b2c14b1e93540"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>writeFileManagerOnSD</b> (void)</td></tr>
<tr class="separator:aca22e5ccdba198907a9b2c14b1e93540"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a318a20be431d81388effc4f5c61549f1" id="r_a318a20be431d81388effc4f5c61549f1"><td class="memItemLeft" align="right" valign="top"><a id="a318a20be431d81388effc4f5c61549f1" name="a318a20be431d81388effc4f5c61549f1"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>readFileManagerFromSD</b> (void)</td></tr>
<tr class="separator:a318a20be431d81388effc4f5c61549f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:af1789ca511292094a59434d03382f90d" id="r_af1789ca511292094a59434d03382f90d"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af1789ca511292094a59434d03382f90d">rotary_enc_count</a> = 0</td></tr>
<tr class="memdesc:af1789ca511292094a59434d03382f90d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Global variables for debugging, debouncing, initialization, and managing fader settings.  <br /></td></tr>
<tr class="separator:af1789ca511292094a59434d03382f90d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4109f6ff3a190165f4c94b0c205faed2" id="r_a4109f6ff3a190165f4c94b0c205faed2"><td class="memItemLeft" align="right" valign="top"><a id="a4109f6ff3a190165f4c94b0c205faed2" name="a4109f6ff3a190165f4c94b0c205faed2"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>switch_push_button</b> = false</td></tr>
<tr class="memdesc:a4109f6ff3a190165f4c94b0c205faed2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Boolean to verify if the encoder switch is pushed. <br /></td></tr>
<tr class="separator:a4109f6ff3a190165f4c94b0c205faed2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a9390b5d6ac67f4b941d32c83932e51" id="r_a0a9390b5d6ac67f4b941d32c83932e51"><td class="memItemLeft" align="right" valign="top"><a id="a0a9390b5d6ac67f4b941d32c83932e51" name="a0a9390b5d6ac67f4b941d32c83932e51"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>debounce</b> = false</td></tr>
<tr class="memdesc:a0a9390b5d6ac67f4b941d32c83932e51"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag to debounce the encoder. <br /></td></tr>
<tr class="separator:a0a9390b5d6ac67f4b941d32c83932e51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50300ba6e38ec30121edcc07ebac42c6" id="r_a50300ba6e38ec30121edcc07ebac42c6"><td class="memItemLeft" align="right" valign="top"><a id="a50300ba6e38ec30121edcc07ebac42c6" name="a50300ba6e38ec30121edcc07ebac42c6"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>init</b> = false</td></tr>
<tr class="memdesc:a50300ba6e38ec30121edcc07ebac42c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag to check if initialization is done. <br /></td></tr>
<tr class="separator:a50300ba6e38ec30121edcc07ebac42c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3303243505ff4e4d3f9339ec7dee7544" id="r_a3303243505ff4e4d3f9339ec7dee7544"><td class="memItemLeft" align="right" valign="top"><a id="a3303243505ff4e4d3f9339ec7dee7544" name="a3303243505ff4e4d3f9339ec7dee7544"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>sortFilesFlag</b> = false</td></tr>
<tr class="memdesc:a3303243505ff4e4d3f9339ec7dee7544"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag to regroup the shown file names. <br /></td></tr>
<tr class="separator:a3303243505ff4e4d3f9339ec7dee7544"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1d905c6ac1a0c9b96dca16153917334" id="r_ae1d905c6ac1a0c9b96dca16153917334"><td class="memItemLeft" align="right" valign="top"><a id="ae1d905c6ac1a0c9b96dca16153917334" name="ae1d905c6ac1a0c9b96dca16153917334"></a>
uint16_t&#160;</td><td class="memItemRight" valign="bottom"><b>cnt</b></td></tr>
<tr class="memdesc:ae1d905c6ac1a0c9b96dca16153917334"><td class="mdescLeft">&#160;</td><td class="mdescRight">Counter to smooth the fader values. <br /></td></tr>
<tr class="separator:ae1d905c6ac1a0c9b96dca16153917334"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae09c5138c25e39489f0bdeae5782b0eb" id="r_ae09c5138c25e39489f0bdeae5782b0eb"><td class="memItemLeft" align="right" valign="top"><a id="ae09c5138c25e39489f0bdeae5782b0eb" name="ae09c5138c25e39489f0bdeae5782b0eb"></a>
uint32_t&#160;</td><td class="memItemRight" valign="bottom"><b>smoothValue</b> [NUM_CHANNELS] = {0}</td></tr>
<tr class="memdesc:ae09c5138c25e39489f0bdeae5782b0eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Array to store smoothed values of the ADC buffer outputs. <br /></td></tr>
<tr class="separator:ae09c5138c25e39489f0bdeae5782b0eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ba1927c2882e3830a9a92af60321b98" id="r_a4ba1927c2882e3830a9a92af60321b98"><td class="memItemLeft" align="right" valign="top"><a id="a4ba1927c2882e3830a9a92af60321b98" name="a4ba1927c2882e3830a9a92af60321b98"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>pastClassPercentADC</b> [NUM_CHANNELS] = {0}</td></tr>
<tr class="memdesc:a4ba1927c2882e3830a9a92af60321b98"><td class="mdescLeft">&#160;</td><td class="mdescRight">Array to cache the previous fader settings. <br /></td></tr>
<tr class="separator:a4ba1927c2882e3830a9a92af60321b98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2c131f9ba93a951665ee03601a52bd0" id="r_ad2c131f9ba93a951665ee03601a52bd0"><td class="memItemLeft" align="right" valign="top"><a id="ad2c131f9ba93a951665ee03601a52bd0" name="ad2c131f9ba93a951665ee03601a52bd0"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>currentClassPercentADC</b> [NUM_CHANNELS] = {0}</td></tr>
<tr class="memdesc:ad2c131f9ba93a951665ee03601a52bd0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Array to store the current fader settings in percentage. <br /></td></tr>
<tr class="separator:ad2c131f9ba93a951665ee03601a52bd0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73a26b30e455654dc4ff2d59edb9f5d8" id="r_a73a26b30e455654dc4ff2d59edb9f5d8"><td class="memItemLeft" align="right" valign="top"><a id="a73a26b30e455654dc4ff2d59edb9f5d8" name="a73a26b30e455654dc4ff2d59edb9f5d8"></a>
char&#160;</td><td class="memItemRight" valign="bottom"><b>faderProzent</b> [2][50]</td></tr>
<tr class="memdesc:a73a26b30e455654dc4ff2d59edb9f5d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Array to hold fader percentage strings for display on the LCD. <br /></td></tr>
<tr class="separator:a73a26b30e455654dc4ff2d59edb9f5d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>: Interface functions for handling user inputs, file management, and display updates </p>
<dl class="section attention"><dt>Attention</dt><dd></dd></dl>
<p>This file contains functions for handling user inputs through encoders and switches, updating the display, and managing file operations. Key functionalities include:</p><ul>
<li>Handling encoder signals and debouncing.</li>
<li>Updating screen display based on file names and fader settings.</li>
<li>Sorting files based on fader values.</li>
<li>Managing file lists and file selection.</li>
<li>Interacting with the ADC for smooth value calculations.</li>
</ul>
<p>This file is essential for the interaction between the user interface and the file management system, ensuring that the display is updated with relevant information and user inputs are processed correctly. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="aa5a2a772fa51a752d6fbe6d902aa4bce" name="aa5a2a772fa51a752d6fbe6d902aa4bce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5a2a772fa51a752d6fbe6d902aa4bce">&#9670;&#160;</a></span>compareADCValues()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void compareADCValues </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks if fader settings have changed and updates accordingly. </p>
<p>This function compares the current fader settings with previous values to determine if any changes have occurred. If changes are detected, it performs the following actions:</p>
<ul>
<li>Compares the current and past fader settings.</li>
<li>Updates the past fader settings with the current values if a change is detected.</li>
<li>Sets a flag to indicate that the file list needs to be sorted.</li>
<li>Saves the current filename and clears the <code>shownFiles</code> array if a change is detected.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>This function uses global variables for fader settings and file management. </dd></dl>

</div>
</div>
<a id="af20a88180db1113be1e89266917d148b" name="af20a88180db1113be1e89266917d148b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af20a88180db1113be1e89266917d148b">&#9670;&#160;</a></span>HAL_ADC_ConvCpltCallback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void HAL_ADC_ConvCpltCallback </td>
          <td>(</td>
          <td class="paramtype">ADC_HandleTypeDef *</td>          <td class="paramname"><span class="paramname"><em>hadc</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Callback function for the ADC conversion. </p>
<p>This function is called when the ADC conversion is complete. It performs the following actions:</p>
<ul>
<li>Calculates the smooth values for all channels of the ADC.</li>
<li>Computes the average values for display and comparison operations.<ul>
<li>These average values are used for displaying on the screen and for the sorting algorithm's comparison operations.</li>
</ul>
</li>
<li>Initializes the character array that will be shown on the display.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">hadc</td><td>Pointer to the ADC handle structure. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a0cd91fd3a9608559c2a87a8ba6cba55f" name="a0cd91fd3a9608559c2a87a8ba6cba55f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0cd91fd3a9608559c2a87a8ba6cba55f">&#9670;&#160;</a></span>HAL_GPIO_EXTI_Callback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void HAL_GPIO_EXTI_Callback </td>
          <td>(</td>
          <td class="paramtype">uint16_t</td>          <td class="paramname"><span class="paramname"><em>GPIO_Pin</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Callback function that responds to encoder signals. </p>
<p>This function handles encoder signals by adjusting the encoder count and cursor position on the display. It also debounces the encoder switch using Timer5 and a debounce flag.</p>
<ul>
<li>If A is High and B is High:<ul>
<li>Decrement the encoder count and increment the cursor position on the display.</li>
</ul>
</li>
<li>If A is High and B is Low:<ul>
<li>Increment the encoder count and decrement the cursor position on the display.</li>
</ul>
</li>
<li>If the switch is pushed:<ul>
<li>Select the file and debounce the encoder switch using Timer5 and the debounce flag.</li>
</ul>
</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">GPIO_pin</td><td>The GPIO pin signals from the MCU related to the encoder and switch. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a8a3b0ad512a6e6c6157440b68d395eac" name="a8a3b0ad512a6e6c6157440b68d395eac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a3b0ad512a6e6c6157440b68d395eac">&#9670;&#160;</a></span>HAL_TIM_PeriodElapsedCallback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void HAL_TIM_PeriodElapsedCallback </td>
          <td>(</td>
          <td class="paramtype">TIM_HandleTypeDef *</td>          <td class="paramname"><span class="paramname"><em>htim</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Callback function triggered when a timer expires. </p>
<p>This function handles timer expirations by performing the following actions:</p>
<p>For Timer5 (tim5):</p><ul>
<li>Resets the debounce flag after Timer5 has elapsed.</li>
<li>Stops Timer5.</li>
</ul>
<p>For Timer3 (tim3):</p><ul>
<li>Sets flags to indicate DMA completion and screen update.</li>
<li>Sets a new timer for the next refresh interval.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">htim</td><td>Pointer to the TIM_HandleTypeDef structure for the current timer. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a0a90e886ffd55777b46a49d913a49a6c" name="a0a90e886ffd55777b46a49d913a49a6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a90e886ffd55777b46a49d913a49a6c">&#9670;&#160;</a></span>listFiles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void listFiles </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>path</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Lists all filenames with a .wav extension from the specified directory on the SD card. </p>
<p>This function opens the directory specified by the <code>path</code> parameter, reads through its contents, and stores filenames with a <code>.wav</code> extension in the <code>fileNamesSDCard</code> array. It performs the following actions:</p>
<ul>
<li>Opens the directory at the specified path.</li>
<li>Iterates through directory entries until reaching the maximum file count or encountering an end-of-directory condition.</li>
<li>Checks if each entry is a file (not a directory) and if it has a <code>.wav</code> extension.</li>
<li>Stores valid filenames in the <code>fileNamesSDCard</code> array.</li>
<li>Closes the directory after reading all entries.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">path</td><td>The directory path on the SD card to search for files.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function assumes that <code>fileNamesSDCard</code> and <code>fileCount</code> are global variables and that <code>MAX_FILES</code> and <code>MAX_FILENAME_LENGTH</code> are defined constants. </dd></dl>

</div>
</div>
<a id="a8ba638cf01ae1b79501208d3ed35c394" name="a8ba638cf01ae1b79501208d3ed35c394"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ba638cf01ae1b79501208d3ed35c394">&#9670;&#160;</a></span>resetShownFiles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void resetShownFiles </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Resets the <code>shownFiles</code> array and updates the number of matched files. </p>
<p>This function sets all entries in the <code>shownFiles</code> array to zero and resets the count of matched files.</p>
<ul>
<li>Sets the memory area of <code>fm.shownFiles</code> to zero using <code>memset</code>.</li>
<li>Resets the <code>num_matched_files</code> field to 0.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>This function is used to clear the list of files currently displayed on the screen. </dd></dl>

</div>
</div>
<a id="a3ce89a950d7397271c896ef778373d7e" name="a3ce89a950d7397271c896ef778373d7e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ce89a950d7397271c896ef778373d7e">&#9670;&#160;</a></span>screenInit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void screenInit </td>
          <td>(</td>
          <td class="paramtype">char(*)</td>          <td class="paramname"><span class="paramname"><em>fileNames</em></span>[MAX_FILENAME_LENGTH]</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the screen and sets up the file manager with random class percentages. </p>
<p>This function initializes the LCD-Display, fills it with black, and updates the screen. It also initializes the file manager with file names and assigns random class percentages for system tests.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fileNames</td><td>Array of file names to be added to the file manager. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="af18dbb5e3f6d43a5504216e1f427cfdd" name="af18dbb5e3f6d43a5504216e1f427cfdd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af18dbb5e3f6d43a5504216e1f427cfdd">&#9670;&#160;</a></span>sortFiles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sortFiles </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sorts filenames for display based on fader settings. </p>
<p>This function sorts filenames by comparing file classes with the fader settings. It performs the following actions:</p>
<ul>
<li>Compares file classes against the fader settings with a threshold of 0.1.</li>
<li>Compares the newly added filenames with the existing ones.</li>
<li>Adds files from the existing file list to the <code>shownFiles</code> in the file manager.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">void</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a613aa0c99c5b2234f909f5f8b0cdc972" name="a613aa0c99c5b2234f909f5f8b0cdc972"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a613aa0c99c5b2234f909f5f8b0cdc972">&#9670;&#160;</a></span>updateScreen()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void updateScreen </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates the display with filenames, the currently selected file, and fader settings. </p>
<p>This function updates the display by performing the following tasks:</p>
<ul>
<li>Extracts filenames from the file manager's <code>shownFiles</code> array.</li>
<li>Sets the current filename to be displayed based on the initialization state.</li>
<li>Displays all filenames in the <code>shownFiles</code> array.</li>
<li>Display the currently selected filename.</li>
<li>Shows the fader settings on the display.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>The function relies on global variables and external functions to interact with the display. </dd></dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="af1789ca511292094a59434d03382f90d" name="af1789ca511292094a59434d03382f90d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1789ca511292094a59434d03382f90d">&#9670;&#160;</a></span>rotary_enc_count</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t rotary_enc_count = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Global variables for debugging, debouncing, initialization, and managing fader settings. </p>
<p>These variables are used for various purposes throughout the program, including debugging, debouncing encoder inputs, initializing states, sorting file names, smoothing ADC values, and displaying fader settings on the LCD. Count variable for debugging purposes. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
