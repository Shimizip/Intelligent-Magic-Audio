\newpage
\section{Durchführung}
Im Anschluss an die Spezifikation des Systems folgt die Beschreibung der Umsetzung der einzelnen Komponenten. In diesem Abschnitt werden die angewandten Ansätze und Methodiken erörtert, die zur Realisierung der einzelnen Komponenten genutzt wurden. Weiterhin wird die Herangehensweise beschrieben, sowie wichtige Erkenntnisse und aufgetretene Probleme während der Implementierungsphase dokumentiert. Abschließend wird die Thematik der Gesamtintegration behandelt, einschließlich der Herausforderungen und der Gründe, warum eine vollständige Integration nicht erreicht wurde.

Da nur ein NUCLEO F7 Board (siehe Abschnitt \ref{sec:stm32-nucleo-f722ze}) zur Verfügung stand, wurden die Komponenten (siehe Abschnitt \ref{sec:schnittstellenbeschreibung-und-integration-der-komponenten}) Audioverarbeitung und Interface im Zusammenspiel mit dem Dateimanagement auf dem, aus ES bereits bekannten, NUCLEO F401RE (siehe Abschnitt \ref{sec:stm32-nucleo-f401re}) Board entwickelt.

Lediglich die Komponente Klassifizierung wurde direkt auf dem F7 Board entwickelt, um direkt korrekte Einschätzungen über mögliche Performanceprobleme zu erlangen.

\subsection{Repository Struktur}

Das gesamte Projekt wurde in einem Git Repository auf dem Gitlab der TH Köln \url{https://gitlab.nt.fh-koeln.de/gitlab/jolux/ima} gespeichert und versioniert.
%Eine Spiegelung liegt im Gitlab des Digitaltechnik-Labors (URL)

\subsubsection{Code}

Die Implementation der Komponenten erfolgt in abgekapselten Testprojekten. 
Planmässig sollen diese nach Fertigstellung in ein Gesamtprojekt integriert werden (siehe Abschnitt \ref{sec:no-gesamtintegration}).

\paragraph{\texttt{/f401\_sd\_card\_audio\_codec\_test/}}

Enthält die Implementation der Audio Engine auf dem F401 Board, sowie die DSP-Operationen welche für die Audiovorverarbeitung der Klassifizierung notwendig sind. Eine detaillierte Beschreibung gibt es in Abschnitt \ref{sec:audio-engine}.

\paragraph{\texttt{/f401\_display\_encoder\_fader\_test/}}

Enthält die Implementation des Interfaces auf dem F401 Board, sowie das Dateimanagement. Eine detaillierte Beschreibung gibt es in Abschnitt \ref{sec:interface}.

\paragraph{\texttt{/f401\_display\_encoder\_fader\_audio\_integration/}}

Enthält die Integration der Interface-, Dateimanagement- und Audioverarbeitungskomponente auf dem F401 Board. Die Integration ist bislang nicht gelungen, mehr dazu in Abschnitt \ref{sec:no-gesamtintegration}.

\paragraph{\texttt{/neuronal\_network/}}

Enthält die Jupyter Notebooks für die Entwicklung des Neuronalen Netzes, sowie die Implementation der eingebetteten Klassifizierung (\path{/neuronal_network/esp_cubeai_test}) und die Teilintegration der Klassifizierungskomponente (\path{/neuronal_network/esp_cubeai_for_integration}). Mehr dazu im \textbf{Abschnitt \ref{sec:nn-training-of-nn-jupyter}} und im \textbf{Abschnitt \ref{sec:stm32-cube-ai}}.

\paragraph{\texttt{/neuronal\_training/}}

Enthält das Python Script für die Lerndatengenerierung, mehr dazu in Abschnitt \ref{sec:input-data-generation}.

\subsubsection{Dokumentation}

\paragraph{\texttt{/doc/}} und alle Unterordner enthält die gesamte Projektdokumentation.

\paragraph{\texttt{/doc/tex/}} enthält die LaTeX Dokumente dieses PDFs.

\paragraph{\texttt{/doc/schematics/}} enthält Schaltbilder für die Teilprojekte: Audioverarbeitung, sowie Interface.

\paragraph{\texttt{/doc/doxygen/}} enthält Generierte \hyperlink{https://www.doxygen.nl/index.html}{Doxygen} Code-Dokumentation.

\paragraph{\texttt{/doc/datasheets/}} enthält Alle verfügbaren Datenblätter der Hardwarekomponenten.

\paragraph{\texttt{/doc/notes/}} enthält Notizen die während des Projektablaufs entstanden sind.

\subsubsection{Hardwaredesign}

\paragraph{\texttt{/hardware/}} enthält Enthält das KiCad Projekt für die Schaltpläne.

\subsubsection{Anderes}

\paragraph{\texttt{/praesi/}} enthält die Powerpoint Projekte für die Milestone-Präsentationen.

\paragraph{\texttt{/util/}} enthält Nützliche Binaries (Zurzeit nur \texttt{riffpad.exe}, ein Tool zum Auslesen von .wav Headern).


\input{08-01_audio}
\include{08-02_neuronales_netz}
\include{Interface/08-03_interface}
\include{08-03_hardware_design}


\subsection{Integration der einzelnen Komponenten in das Gesamtsystem}
\label{sec:no-gesamtintegration}
\vspace{1em}

Leider konnte aufgrund von Zeitmangel die Integration der einzelnen Komponenten in ein Gesamtsystem nicht realisiert werden. Verschiedene Ursachen trugen zu diesen zeitlichen Verzögerungen bei.

Wie bereits in den vorherigen Abschnitten erwähnt, führten Probleme bei der Implementierung zu erheblichen Zeitverlusten. Insbesondere verursachte ein ``Hard-Fault``-Fehler auf dem STM Board in der Klassifizierungskomponente lange Verzögerungen, da die Ursache schwer zu identifizieren war.

Anfänglich gab es auch Schwierigkeiten beim Auslesen der SD-Karte, da der zunächst verwendete Treiber\cite{spi-sd-card} nicht für die Nutzung von SD-Karten der Version 3 ausgelegt war. Der Einsatz von älteren SD-Karten-Versionen erwies sich als erfolgreich. Allerdings war die Datenübertragung über SPI aufgrund des verwendeten Treibers nicht effizient genug, was letztlich zum Umstieg auf die SDIO-Schnittstelle führte.

Ein weiteres Hindernis war die Verfügbarkeit von nur einem Nucleo-F7-Board für das gesamte Team, welches bis zuletzt durch die Implementierung des neuronalen Netzes in Anspruch genommen wurde. Die Entwicklung der übrigen Komponenten erfolgte daher auf Nucleo-F4-Boards. Die Portierung dieser Projekte auf das F7-Board gestaltete sich dann wesentlich aufwendiger als angenommen. Das DMA-Verhalten auf dem F7-Board entsprach nicht den Erwartungen, und aufgrund der begrenzten Zeit konnte dieses Problem nicht gelöst werden. 
Dies erschwerte die Integration der Teilprojekte erheblich.

Der Versuch, die Teilprojekte Audio und Interface auf das F4-Board zu portieren, scheiterte ebenfalls aufgrund von Pointer-Problemen bei der Auswahl der abzuspielenden Datei. Eine Lösung des Problems stand in Aussicht, musste allerdings wieder aufgrund von Zeitmangel eingestellt werden.

Obwohl einzelne Komponenten schließlich für die Integration in das Gesamtsystem vorbereitet wurden, kam es zu keiner tatsächlichen Zusammenführung in einem einheitlichen Projekt.

Die größten Schwierigkeiten bei der Integration waren die Nutzung uns zuvor unbekannter Technologien wie CUBE.AI, der Mangel an Ressourcen in Bezug auf die Verfügbarkeit des F7-Boards und vor allem die Zeit als kritischer Faktor, der die verspätete Portierung von Projekten verursachte.


